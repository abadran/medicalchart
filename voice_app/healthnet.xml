<?xml version="1.0" ?>
<vxml version="2.1">

<!-- *************************************************************** -->
<!-- * Turn on all universal grammars. The predefined universal    * -->
<!-- * grammars are help, exit, cancel, and goback.                * -->
<!-- *************************************************************** -->

<property name="universals" value="all" />

<help>I'm sorry. There's no help available here.</help>

<noinput>I'm sorry.  I didn't hear anything.
	<reprompt/>
</noinput>

<nomatch>I didn't get that.
	<reprompt/>
</nomatch>

<var name="temperature"/>
<var name="pulse"/>
<var name="systolic"/>
<var name="diastolic"/>
<var name="glucose"/>
<var name="pain"/>


<link next="#mainMenu">
  <grammar type="application/srgs+xml" root="main">
    <rule id="main">
        <one-of>
            <item>main menu</item>
            <item>add more</item>
            <item>more</item>
        </one-of>
    </rule>
  </grammar>
</link>

<link next="#submit">
  <grammar type="application/srgs+xml" root="submit">
    <rule id="submit">
        <one-of>
            <item>submit</item>
            <item>submit data</item>
        </one-of>
    </rule>
  </grammar>
</link>


<!-- The greeting -->
<form id="greeting">
    <block>
        <prompt>
            Welcome to your Health Net!
            <break strength="weak"/>
        </prompt>
        <goto next="#mainMenu" />
    </block>
</form>

<form id="temperature">
    <field name="t" type="number">
	<noinput count="1"><prompt>Please say your temperature.</prompt></noinput>
	<noinput count="2"><prompt>Please say your temperature as it appears on your device. For example, say <emphasis>98.6</emphasis>. You can also say help, or press 0 at any time to be connected to an operator.</prompt></noinput>
	<noinput count="3"><prompt>I'm sorry, I will connect you to a customer service representative who will be able to assist you.</prompt></noinput>
	<nomatch count="1"><prompt>I'm sorry, I did not get that. Please say your temperature.</prompt></nomatch>
	<nomatch count="2"><prompt>I am sorry, I am still unable to get your temperature. For example, say <emphasis>98.6</emphasis></prompt></nomatch>
	<nomatch count="3"><prompt>I'm sorry,  I will connect you to a customer service representative who will be able to assist you.</prompt></nomatch>
	<prompt cond="null==temperature">Temperature</prompt>
        <prompt cond="null!=temperature">
            We have your temperature as <value expr="temperature"/>
            <sub alias="degrees Fahrenheit">F</sub>.
            You can say a new value or go back.
        </prompt>
        <filled>
          <assign name="temperature" expr="Number(t)"/>
          <prompt><value expr="temperature"/>, ok.</prompt>
          <goto next="#mainMenu"/>
        </filled>
    </field>
</form>

<form id="pulse">
    <field name="p" type="number">
       	<noinput count="1"><prompt>Please say your heart rate</prompt></noinput>
	<noinput count="2"><prompt>Please say your heart rate as it appears on your device. For example, say <emphasis>75</emphasis>. You can also say help, or press 0 at any time to be connected to an operator.</prompt></noinput>
	<noinput count="3"><prompt>I'm sorry, I will connect you to a customer service representative who will be able to assist you.</prompt></noinput>
	<nomatch count="1"><prompt>I'm sorry, I did not get that. Please say your heart rate.</prompt></nomatch>
	<nomatch count="2"><prompt>I am sorry, I am still unable to get your heart rate. For example, say <emphasis>75</emphasis></prompt></nomatch>
	<nomatch count="3"><prompt>I'm sorry,  I will connect you to a customer service representative who will be able to assist you.</prompt></nomatch>
	<prompt cond="null==pulse">Heart rate</prompt>
        <prompt cond="null!=pulse">
            We have your heart rate as <value expr="pulse"/>
            <sub alias="beats per minute">bpm</sub>.
            You can say a new value or go back.
        </prompt>
        <filled>
          <assign name="pulse" expr="Number(p)"/>
          <prompt><value expr="pulse"/>, ok.</prompt>
          <goto next="#mainMenu"/>
        </filled>
    </field>
</form>

<form id="pressure">
    <field name="s" type="number" >
        <prompt>Systolic?</prompt>
    </field>
    <field name="d" type="number" >
        <prompt>Diastolic?</prompt>
    </field>
    <filled mode="all">
      <assign name="systolic" expr="Number(s)"/>
      <assign name="diastolic" expr="Number(d)"/>
      <prompt><value expr="systolic"/> <sub alias="over">/</sub> <value expr="diastolic"/>, ok.</prompt>
      <goto next="#mainMenu"/>
    </filled>
</form>

<form id="glucose">
    <field name="g" type="number">
       	<noinput count="1"><prompt>Please say your glucose level.</prompt></noinput>
	<noinput count="2"><!-- TODO: Fix the range for the glucose level -->
		<prompt>Please say your glucose level as it appears on your device. For example, say <emphasis>75</emphasis>. You can also say help, or press 0 at any time to be connected to an operator.</prompt>
	</noinput>
	<noinput count="3"><prompt>I'm sorry, I will connect you to a customer service representative who will be able to assist you.</prompt></noinput>
	<nomatch count="1"><prompt>I'm sorry, I did not get that. Please say your glucose level.</prompt></nomatch>
	<nomatch count="2"><prompt>I am sorry, I am still unable to get your glucose level. For example, say <emphasis>75</emphasis></prompt></nomatch>
	<nomatch count="3"><prompt>I'm sorry,  I will connect you to a customer service representative who will be able to assist you.</prompt></nomatch>
	<prompt cond="null==glucose">Glucose?</prompt>
        <prompt cond="null!=glucose">
            We have your glucose level as <value expr="glucose"/>
            <sub alias="miligrams per decalitre">mg/dl</sub>.
            You can say a new value or go back.
        </prompt>
        <filled>
          <assign name="glucose" expr="Number(g)"/>
          <prompt><value expr="glucose"/>, ok.</prompt>
          <goto next="#mainMenu"/>
        </filled>
    </field>
</form>

<form id="pain">
    <field name="p" type="number">
       	<noinput count="1"><prompt>Please say your overall feeling.</prompt></noinput>
	<noinput count="2"><prompt>Please say your overall feeling between 1 and 10, 1 is no pain, 10 is unbearable pain. You can also say help, or press 0 at any time to be connected to an operator.</prompt></noinput>
	<noinput count="3"><prompt>I'm sorry, I will connect you to a customer service representative who will be able to assist you.</prompt></noinput>
	<nomatch count="1"><prompt>I'm sorry, I did not get that. Please say your overall feeling.</prompt></nomatch>
	<nomatch count="2"><prompt>I am sorry, I am still unable to get your overall feeling. Please state your overall feeling between 1 and 10, 1 is no pain, 10 is unbearable pain</prompt></nomatch>
	<nomatch count="3"><prompt>I'm sorry,  I will connect you to a customer service representative who will be able to assist you.</prompt></nomatch>
	<prompt cond="null==pain">Overall Feeling?</prompt>
        <prompt cond="null!=pain">
            We have your overall feeling as <value expr="pain"/>.
            You can say a new value or go back.
        </prompt>
        <filled>
          <assign name="pain" expr="Number(p)"/>
          <prompt><value expr="pain"/>, ok.</prompt>
          <goto next="#mainMenu"/>
        </filled>
    </field>
</form>


<form id="submit">
    <block cond="null==temperature &amp;&amp; null==pulse &amp;&amp; null==systolic &amp;&amp; null==glucose &amp;&amp; null==pain">
        <prompt>
            <emphasis level="reduced">You cannot submit an empty form. Redirecting to main menu</emphasis><break/>
        </prompt>
        <goto next="#mainMenu" />
    </block>
    <block>
        <prompt>
            Ok! Your data was sent to your medical office. Good bye.
        </prompt>
        <exit/>
    </block>
</form>

<form id="review">
    <block cond="null==temperature &amp;&amp; null==pulse &amp;&amp; null==systolic &amp;&amp; null==glucose &amp;&amp; null==pain">
        <prompt>
            <emphasis level="reduced">You entered no information so far.</emphasis><break/>
        </prompt>
        <goto next="#mainMenu" />
    </block>
    <block>
        <prompt>
            Here is the data we have so far:<break/>
        </prompt>
        <prompt cond="null!=temperature">
            <emphasis>Temperature:</emphasis><break/>
            <value expr="temperature"/>
	    <sub alias="degrees Fahrenheit">F</sub><break/>
        </prompt>
        <prompt cond="null!=pulse">
            <emphasis>Heart Rate:</emphasis><break/>
            <value expr="pulse"/>
	    <sub alias="beats per minute">bpm</sub><break/>
        </prompt>
        <prompt cond="null!=systolic">
            <emphasis>Blood Pressure:</emphasis><break/>
            <value expr="systolic"/>
            <sub alias="over">/</sub>
	    <value expr="diastolic"/><break/>
        </prompt>
        <prompt cond="null!=glucose">
            <emphasis>Glucose Level:</emphasis><break/>
            <value expr="glucose"/>
	    <sub alias="miligrams per decalitre">mg/dl</sub><break/>
        </prompt>
        <prompt cond="null!=pain">
            <emphasis>Overall Feeling:</emphasis><break/>
            <value expr="pain"/>
        </prompt>
    </block>
    <block cond="null==temperature||null==pulse||null==systolic||null==glucose||null==pain">
        <prompt>
            We don't yet have data for:<break/>
        </prompt>
        <prompt cond="null==temperature">
            <emphasis>Temperature,</emphasis><break/>
        </prompt>
        <prompt cond="null==pulse">
            <emphasis>Heart Rate,</emphasis><break/>
        </prompt>
        <prompt cond="null==systolic">
            <emphasis>Blood Pressure,</emphasis><break/>
        </prompt>
        <prompt cond="null==glucose">
            <emphasis>Glucose Level,</emphasis><break/>
        </prompt>
        <prompt cond="null==pain">
            <emphasis>Overall Feeling,</emphasis><break/>
        </prompt>
    </block>
    <field name="choice">
	<prompt>
            <emphasis>Submit</emphasis> the data or <emphasis>add more</emphasis>?
        </prompt>
	<grammar type="application/grammar-xml" mode="voice" root="choice_rule">
		<rule id="choice_rule">
			<one-of>
				<item>submit  <tag><![CDATA[  <choice "submit">  ]]>  </tag>   </item>
				<item>add more<tag><![CDATA[  <choice "add more">  ]]>  </tag>   </item>
			</one-of>
		</rule>
	</grammar>
	<filled>
		<if     cond="choice=='submit'">
			<goto next="#submit"/>
		<elseif cond="choice=='add more'"/>
			<goto next="#mainMenu"/>
		<else/>
			<prompt>Selection is unknown at this point</prompt>
		</if>
	</filled>
    </field>
</form>

<menu id="mainMenu">
    <prompt cond="null==temperature||null==pulse||null==systolic||null==glucose||null==pain">
        <emphasis level="reduced">Which measurement?</emphasis><break/>
    </prompt>
    <prompt cond="null!=temperature &amp;&amp; null!=pulse &amp;&amp; null!=systolic &amp;&amp; null!=glucose &amp;&amp; null!=pain">
        Do you want to <emphasis>review</emphasis> your data or <emphasis>submit</emphasis>?
    </prompt>
    <prompt cond="null==temperature">
        <emphasis>Temperature?</emphasis><break/>
    </prompt>
    <prompt cond="null==pulse">
        <emphasis>Heart Rate?</emphasis><break/>
    </prompt>
    <prompt cond="null==systolic">
        <emphasis>Blood Pressure?</emphasis><break/>
    </prompt>
    <prompt cond="null==glucose">
        <emphasis>Glucose Level?</emphasis><break/>
    </prompt>
    <prompt cond="null==pain">
        <emphasis level="reduced">or</emphasis><break/>
        <emphasis>Overall Feeling?</emphasis><break/>
    </prompt>
    <choice next="#temperature"                  >temperature</choice>
    <choice next="#pulse"    accept="approximate">heart</choice>
    <choice next="#pulse"    accept="approximate">pulse</choice>
    <choice next="#pressure" accept="approximate">blood pressure</choice>
    <choice next="#glucose"  accept="approximate">glucose</choice>
    <choice next="#glucose"  accept="approximate">sugar</choice>
    <choice next="#pain"     accept="approximate">pain</choice>
    <choice next="#pain"                         >overall feeling</choice>
    <choice next="#review"                       >review</choice>
    <choice next="#submit"                       >submit</choice>
    <noinput count="1"><prompt>I'm sorry, no selection has been made, please select a reading like <emphasis>temperature</emphasis></prompt></noinput>
    <noinput count="2"><prompt>Please select a reading. For example, to select <emphasis>pressure</emphasis>, say <emphasis>pressure</emphasis>. You can also say help, at any time for help, or press 0 to be connected to an operator.</prompt></noinput>
    <noinput count="3"><prompt>I'm sorry, I will connect you to a customer service representative who will be able to assist you.</prompt></noinput>
    <nomatch count="1"><prompt>I'm sorry, I did not get that. Please make a selection.</prompt></nomatch>
    <nomatch count="2"><prompt>I am sorry, I am still unable to get your selection. For example, to select <emphasis>pressure</emphasis>, say <emphasis>pressure</emphasis>.</prompt></nomatch>
    <nomatch count="3"><prompt>I'm sorry,  I will connect you to a customer service representative who will be able to assist you.</prompt></nomatch>
</menu>

</vxml>
